<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Receitas - Dashboard Administrativo</title>

    <link rel="stylesheet" href="../styles/global.css" />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <header>
      <nav id="navbar-admin" aria-label="Navegação Principal do Painel"></nav>
    </header>

    <main class="container mt-4">
      <section>
        <div class="row">
          <div class="col my-auto mb-2">
            <h4 class="m-0">Consulta de Receitas</h4>
          </div>
          <div class="col-md-3 mb-2">
            <div class="d-grid gap-2">
              <a
                href="cadastro-receitas.html"
                class="btn btn-primary"
                aria-label="Ir para a página de cadastro de nova receita"
                >Adicionar Receita</a
              >
            </div>
          </div>
        </div>
      </section>
      <hr />

      <section
        class="row mb-3"
        aria-label="Opções de busca e filtragem de receitas"
      >
        <div class="col-md-6">
          <div class="input-group">
            <label for="buscarReceita" class="visually-hidden"
              >Buscar por nome da receita</label
            >
            <input
              type="text"
              class="form-control"
              id="buscarReceita"
              placeholder="Buscar por nome da receita..."
              aria-describedby="btnBuscarReceitaHelp"
            />
            <button
              class="btn btn-outline-secondary"
              type="button"
              id="btnBuscarReceita"
              aria-label="Executar busca por nome da receita"
            >
              Buscar
            </button>
            <div id="btnBuscarReceitaHelp" class="visually-hidden">
              Pressione para buscar receitas pelo nome digitado.
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <label for="filtroCategoria" class="visually-hidden"
            >Filtrar por categoria</label
          >
          <select
            class="form-select"
            id="filtroCategoria"
            aria-label="Filtrar receitas por categoria"
          >
            <option value="">Todas as categorias</option>
            <option value="entrada">Entrada</option>
            <option value="prato_principal">Prato Principal</option>
            <option value="sobremesa">Sobremesa</option>
            <option value="bebida">Bebida</option>
            <option value="lanche">Lanche</option>
            <option value="acompanhamento">Acompanhamento</option>
          </select>
        </div>
        <div class="col-md-3">
          <label for="ordenarPor" class="visually-hidden"
            >Ordenar lista de receitas por</label
          >
          <select
            class="form-select"
            id="ordenarPor"
            aria-label="Ordenar receitas por"
          >
            <option value="nome">Ordenar por Nome</option>
            <option value="categoria">Ordenar por Categoria</option>
            <option value="tempo">Ordenar por Tempo</option>
            <option value="custo">Ordenar por Custo</option>
          </select>
        </div>
      </section>

      <section class="card" aria-labelledby="lista-receitas-heading">
        <div
          class="card-header d-flex justify-content-between align-items-center"
        >
          <h5 class="card-title mb-0" id="lista-receitas-heading">
            Lista de Receitas
          </h5>
          <span
            class="badge bg-primary"
            id="totalReceitas"
            aria-live="polite"
          ></span>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped table-hover">
              <caption>
                Tabela com a lista de receitas cadastradas, incluindo categoria,
                tempo de preparo, rendimento e custos.
              </caption>
              <thead class="table-dark">
                <tr>
                  <th scope="col">Nome</th>
                  <th scope="col">Categoria</th>
                  <th scope="col">Tempo (min)</th>
                  <th scope="col">Rendimento</th>
                  <th scope="col">Custo Total</th>
                  <th scope="col">Custo/Porção</th>
                  <th scope="col">Ações</th>
                </tr>
              </thead>
              <tbody id="tabelaReceitas">
                <tr>
                  <td colspan="7" class="text-center text-muted py-5">
                    <div class="spinner-border text-dark" role="status">
                      <span class="visually-hidden"
                        >Carregando receitas...</span
                      >
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <section class="row mt-4" aria-labelledby="estatisticas-receitas-heading">
        <h2 id="estatisticas-receitas-heading" class="visually-hidden">
          Estatísticas de Receitas
        </h2>
        <div class="col-md-3">
          <div class="card border-primary">
            <div class="card-body text-center">
              <h3 class="card-title text-primary">Total de Receitas</h3>
              <p
                class="h2 text-primary"
                id="estatisticaTotal"
                aria-live="polite"
              >
                0
              </p>
              <p class="card-text">Total de receitas cadastradas</p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card border-success">
            <div class="card-body text-center">
              <h3 class="card-title text-success">Receita Mais Barata</h3>
              <p
                class="h2 text-success"
                id="receitaMaisBarata"
                aria-live="polite"
              >
                R$ 0,00
              </p>
              <p class="card-text">
                Custo por porção da receita mais econômica
              </p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card border-warning">
            <div class="card-body text-center">
              <h3 class="card-title text-warning">Receita Mais Cara</h3>
              <p
                class="h2 text-warning"
                id="receitaMaisCara"
                aria-live="polite"
              >
                R$ 0,00
              </p>
              <p class="card-text">Custo por porção da receita mais cara</p>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card border-info">
            <div class="card-body text-center">
              <h3 class="card-title text-info">Tempo Médio</h3>
              <p class="h2 text-info" id="tempoMedio" aria-live="polite">
                0 min
              </p>
              <p class="card-text">
                Tempo médio de preparo de todas as receitas
              </p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <div
      class="modal fade"
      id="modalVisualizarReceita"
      tabindex="-1"
      aria-labelledby="tituloVisualizarReceita"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h2 class="modal-title fs-5" id="tituloVisualizarReceita">
              Visualizar Receita
            </h2>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Fechar"
            ></button>
          </div>
          <div class="modal-body">
            <!-- Informações Gerais -->
            <div class="row mb-3">
              <div class="col-md-6">
                <p>
                  <strong>Categoria:</strong>
                  <span id="categoriaReceitaDetalhe" class="text-muted"></span>
                </p>
                <p>
                  <strong>Dificuldade:</strong>
                  <span id="dificuldadeDetalhe" class="text-muted"></span>
                </p>
                <p>
                  <strong>Tempo de Preparo:</strong>
                  <span id="tempoPreparoDetalhe" class="text-muted"></span>
                  minutos
                </p>
                <p>
                  <strong>Rendimento:</strong>
                  <span id="rendimentoDetalhe" class="text-muted"></span>
                  porções
                </p>
              </div>
              <div class="col-md-6">
                <p>
                  <strong>Custo Total:</strong>
                  <span id="custoTotalModal" class="text-muted"></span>
                </p>
                <p>
                  <strong>Custo por Porção:</strong>
                  <span id="custoPorcaoModal" class="text-muted"></span>
                </p>
                <p>
                  <strong>Observações:</strong><br />
                  <span id="observacoesDetalhe" class="text-muted"></span>
                </p>
              </div>
            </div>

            <hr />

            <!-- Ingredientes -->
            <h5>Ingredientes</h5>
            <div class="table-responsive">
              <table class="table table-sm table-striped">
                <thead>
                  <tr>
                    <th>Ingrediente</th>
                    <th>Quantidade</th>
                    <th>Unidade</th>
                  </tr>
                </thead>
                <tbody id="ingredientesLista">
                  <tr>
                    <td colspan="4" class="text-center text-muted">
                      Nenhum ingrediente listado.
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <hr />

            <!-- Modo de Preparo -->
            <h5>Modo de Preparo</h5>
            <div id="modoPreparoDetalhe" class="border p-3 bg-light rounded">
              <p class="text-muted">Nenhum modo de preparo disponível.</p>
            </div>
          </div>

          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Fechar
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="editarReceita()"
            >
              Editar Receita
            </button>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      id="modalEditarReceita"
      tabindex="-1"
      aria-labelledby="tituloModalEditarReceita"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h2 class="modal-title fs-5" id="tituloModalEditarReceita">
              Editar Receita
            </h2>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Fechar formulário de edição de receita"
            ></button>
          </div>
          <div class="modal-body">
            <form id="formEditarReceita">
              <input type="hidden" id="editarReceitaId" />
              <div class="mb-3">
                <label for="editarNomeReceita" class="form-label"
                  >Nome da Receita</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="editarNomeReceita"
                  required
                  aria-required="true"
                  aria-describedby="editarNomeReceitaHelp"
                />
                <div
                  id="editarNomeReceitaHelp"
                  class="form-text visually-hidden"
                >
                  Nome pelo qual a receita será identificada.
                </div>
              </div>
              <div class="mb-3">
                <label for="editarDescricaoReceita" class="form-label"
                  >Descrição</label
                >
                <textarea
                  class="form-control"
                  id="editarDescricaoReceita"
                  rows="3"
                  aria-describedby="editarDescricaoReceitaHelp"
                ></textarea>
                <div
                  id="editarDescricaoReceitaHelp"
                  class="form-text visually-hidden"
                >
                  Breve descrição ou introdução da receita.
                </div>
              </div>
              <div class="row">
                <div class="col-md-4">
                  <div class="mb-3">
                    <label for="editarTempoReceita" class="form-label"
                      >Tempo de Preparo (min)</label
                    >
                    <input
                      type="number"
                      class="form-control"
                      id="editarTempoReceita"
                      min="1"
                      required
                      aria-required="true"
                      aria-describedby="editarTempoReceitaHelp"
                    />
                    <div
                      id="editarTempoReceitaHelp"
                      class="form-text visually-hidden"
                    >
                      Tempo estimado para o preparo da receita em minutos.
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="mb-3">
                    <label for="editarRendimentoReceita" class="form-label"
                      >Rendimento (porções)</label
                    >
                    <input
                      type="number"
                      class="form-control"
                      id="editarRendimentoReceita"
                      min="1"
                      required
                      aria-required="true"
                      aria-describedby="editarRendimentoReceitaHelp"
                    />
                    <div
                      id="editarRendimentoReceitaHelp"
                      class="form-text visually-hidden"
                    >
                      Número de porções ou unidades que a receita rende.
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="mb-3">
                    <label for="editarCategoriaReceita" class="form-label"
                      >Categoria</label
                    >
                    <select
                      class="form-select"
                      id="editarCategoriaReceita"
                      required
                      aria-required="true"
                      aria-describedby="editarCategoriaReceitaHelp"
                    >
                      <option value="entrada">Entrada</option>
                      <option value="prato_principal">Prato Principal</option>
                      <option value="sobremesa">Sobremesa</option>
                      <option value="bebida">Bebida</option>
                      <option value="lanche">Lanche</option>
                      <option value="acompanhamento">Acompanhamento</option>
                    </select>
                    <div
                      id="editarCategoriaReceitaHelp"
                      class="form-text visually-hidden"
                    >
                      Categoria culinária da receita.
                    </div>
                  </div>
                </div>
              </div>
              <div class="mb-3">
                <label for="editarModoPreparoReceita" class="form-label"
                  >Modo de Preparo</label
                >
                <textarea
                  class="form-control"
                  id="editarModoPreparoReceita"
                  rows="6"
                  required
                  aria-required="true"
                  aria-describedby="editarModoPreparoReceitaHelp"
                ></textarea>
                <div
                  id="editarModoPreparoReceitaHelp"
                  class="form-text visually-hidden"
                >
                  Instruções detalhadas sobre como preparar a receita.
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="salvarEdicaoReceita()"
              aria-label="Salvar as alterações na receita"
            >
              Salvar Alterações
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="../scripts/components.js"></script>
    <script src="../scripts/app.js" type="module"></script>
    <script src="../scripts/admin/receitas.js" type="module"></script>

    <script defer src="/__/firebase/11.9.0/firebase-app-compat.js"></script>
    <script defer src="/__/firebase/11.9.0/firebase-auth-compat.js"></script>
    <script
      defer
      src="https://www.gstatic.com/firebasejs/11.9.0/firebase-firestore-compat.js"
    ></script>
    <script defer src="/__/firebase/init.js?useEmulator=true"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
